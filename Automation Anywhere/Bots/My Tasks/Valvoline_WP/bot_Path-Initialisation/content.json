{"nodes":[{"uid":"cc988d7e-722b-4ccb-8904-21e1bee92905","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"-- Log-Path and Email Initialisation Bot --"}}]},{"uid":"540db60e-1d46-4790-87d2-2a46df9f6ba8","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"},"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Automation%20Anywhere/My%20Docs/Valvoline_WP/Configuration_Files/Email-Logs_Configuration.csv"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}]}],"children":[{"uid":"5351ee59-ff35-4f29-ad34-e2bfd2b5537a","commandName":"OpenCSVTXT","packageName":"CsvTxt","attributes":[{"name":"session","value":{"type":"STRING","string":"S1"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$@AAApplicationPath$/Automation%20Anywhere/My%20Docs/Valvoline_WP/Configuration_Files/Email-Logs_Configuration.csv"}},{"name":"delimeter","value":{"type":"STRING","string":"comma"}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"encoding","value":{"type":"STRING","string":"ansi"}},{"name":"trimTrailingSpace","value":{"type":"BOOLEAN","boolean":false}},{"name":"trimLeadingSpace","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"ac770519-0d28-40f2-b458-35707be40971","commandName":"ReadFromCsvTxt","packageName":"CsvTxt","attributes":[{"name":"session","value":{"type":"STRING","string":"S1"}}],"returnTo":{"type":"VARIABLE","variableName":"CSV-TXT-S1-DATA"}},{"uid":"7705a662-6efb-4e44-ac83-1568b8ecd8fc","commandName":"CloseCsvTxt","packageName":"CsvTxt","attributes":[{"name":"session","value":{"type":"STRING","string":"S1"}}]},{"uid":"8108c191-5b32-4353-b9bb-b9e42539a34f","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"c3e423bb-c3f2-4581-88ce-7de17b1f52f4","commandName":"loop.commands.start","packageName":"Loop","attributes":[{"name":"iterator","value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"},"returnTo":{"type":"VARIABLE","variableName":"Loop-Filedata-Column-1"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"CSV-TXT-S1-DATA"}}]},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}],"children":[{"uid":"14045466-a7c8-4315-84ae-f92e56d4bbdd","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-1.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"89c95630-1288-464d-bea2-e7e752587244","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$Loop-Counter-1$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"2"}}]}],"children":[{"uid":"eb856e00-4def-4e4b-acf8-01822950a3b1","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Filedata-Column-1[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"v_Email-From"}},{"uid":"63fb4818-1590-4d82-8d40-27a14d673afc","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Filedata-Column-1[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"v_End-User-Email-To"}},{"uid":"792036a4-5490-4003-b088-954839e30822","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Filedata-Column-1[2]$"}}],"returnTo":{"type":"VARIABLE","variableName":"v_Support-Email-To"}},{"uid":"026e0ea7-08eb-4b91-a341-4b62b4caf879","commandName":"loop.commands.break","packageName":"Loop","attributes":[]}]}]},{"uid":"d80f2d2f-22e4-4dcd-96e0-3febe784f3d4","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$v_Email-From$\n$v_End-User-Email-To$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]},{"uid":"db29e7b8-9379-4982-873e-6bbe54b0e732","commandName":"stopTask","packageName":"TaskBot","disabled":true,"attributes":[]},{"uid":"6615cbfb-3532-4b57-a0dd-d1e56ce73ba1","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$@AAApplicationPath$\\Automation Anywhere\\My Docs\\Valvoline_WP\\Logs\\Audit_Logs\\$System:Day.Number:toString$-$System:Month.Number:toString$-$System:Year.Number:toString$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}]}],"children":[{"uid":"85bb14be-c2b9-4721-acef-5b430f567235","commandName":"createFolder","packageName":"Folder","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$@AAApplicationPath$\\Automation Anywhere\\My Docs\\Valvoline_WP\\Logs\\Audit_Logs\\$System:Day.Number:toString$-$System:Month.Number:toString$-$System:Year.Number:toString$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}]},{"uid":"912e0a60-b01a-4656-9ae5-6471f2e221cc","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$@AAApplicationPath$\\Automation Anywhere\\My Docs\\Valvoline_WP\\Logs\\Error_Logs\\$System:Day.Number:toString$-$System:Month.Number:toString$-$System:Year.Number:toString$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}]}],"children":[{"uid":"a7f1f958-00bf-49ca-93bd-efa1d645739a","commandName":"createFolder","packageName":"Folder","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$@AAApplicationPath$\\Automation Anywhere\\My Docs\\Valvoline_WP\\Logs\\Error_Logs\\$System:Day.Number:toString$-$System:Month.Number:toString$-$System:Year.Number:toString$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}]},{"uid":"8327f2ce-1127-49d9-a3b9-a3452bd8fca3","commandName":"if","packageName":"If","attributes":[{"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$@AAApplicationPath$\\Automation Anywhere\\My Docs\\Valvoline_WP\\Logs\\Error_Logs\\$System:Day.Number:toString$-$System:Month.Number:toString$-$System:Year.Number:toString$\\Error_Screenshot"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}]}],"children":[{"uid":"a6b910ac-5aa6-4951-bcdc-e45b8941a1af","commandName":"createFolder","packageName":"Folder","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$@AAApplicationPath$\\Automation Anywhere\\My Docs\\Valvoline_WP\\Logs\\Error_Logs\\$System:Day.Number:toString$-$System:Month.Number:toString$-$System:Year.Number:toString$\\Error_Screenshot"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}]}],"branches":[{"uid":"90fc67fa-8130-4bab-99f8-b3c49c332bcc","commandName":"else","packageName":"If","attributes":[],"children":[{"uid":"83e01a25-c5f6-4db3-b33b-b10e5ea32917","commandName":"systemInformation","packageName":"System","attributes":[{"name":"systemNameBySelection","value":{"type":"STRING","string":"COMPUTERNAME","label":"COMPUTERNAME"}},{"name":"variableOption","value":{"type":"STRING","string":"BY_SELECTION"}}],"returnTo":{"type":"VARIABLE","variableName":"m-string-1"}},{"uid":"99f51786-0b1d-45ac-948f-24ffa88c0d1f","commandName":"sendMail","packageName":"Email","attributes":[{"name":"fromAddress","value":{"type":"STRING","expression":"$System:AATaskExecutor{\"Executor_Email\"}$"}},{"name":"toAddress","value":{"type":"STRING","expression":"$System:AATaskExecutor{\"Executor_Email\"}$,$System:AATaskInvoker{\"Invoker_Email\"}$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"Valvoline WP Configuration File Missing"}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Hi Team,\n\nValvoline WP Configuration File Missing. Please place the file at location - $@AAApplicationPath$\\Automation Anywhere\\My Docs\\Valvoline_WP\\Configuration_Files\\Email-Logs_Configuration.csv.\n\nRegards\n$m-string-1$ "}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","expression":"$@AAE_EmailSettings_ssl$"}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","expression":"$@AAE_EmailSettings_auth$"}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"lockerName":"AAE_Email","name":"AAE_EmailSettings","attributeName":"userName"}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"lockerName":"AAE_Email","name":"AAE_EmailSettings","attributeName":"password"}}}]}]}]},{"uid":"bb7014c1-6267-48ea-9a30-81fe5ae2e53c","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$@AAApplicationPath$\\Automation Anywhere\\My Docs\\Valvoline_WP\\Logs\\Audit_Logs\\$System:Day.Number:toString$-$System:Month.Number:toString$-$System:Year.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"v_Audit-Log-Path"}},{"uid":"548f4c8f-69ae-4378-a714-9b2262bc6d38","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$v_Audit-Log-Path.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"v_Audit-Log-Path"}},{"uid":"b80d1bda-f798-4b7b-9da4-525e6fe44f17","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$v_Audit-Log-Path$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]},{"uid":"241cb706-1a0b-48ee-8208-7814fe33d459","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$@AAApplicationPath$\\Automation Anywhere\\My Docs\\Valvoline_WP\\Logs\\Error_Logs\\$System:Day.Number:toString$-$System:Month.Number:toString$-$System:Year.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"v_Error-Log-Path"}},{"uid":"c0b96521-8439-49e4-8b5f-e9d4308f633e","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$v_Error-Log-Path.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"v_Error-Log-Path"}},{"uid":"e553748a-792f-47db-a4d5-6bb0949452f6","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$v_Error-Log-Path$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]},{"uid":"d6a05f49-6940-4055-8a2d-bdd54e364ba2","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$@AAApplicationPath$\\Automation Anywhere\\My Docs\\Valvoline_WP\\Logs\\Error_Logs\\$System:Day.Number:toString$-$System:Month.Number:toString$-$System:Year.Number:toString$\\Error_Screenshot"}}],"returnTo":{"type":"VARIABLE","variableName":"v_Error_Screenshot_Path"}},{"uid":"727047d9-1403-49ce-9ddb-14932d9c1348","commandName":"assign","packageName":"String","attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$v_Error_Screenshot_Path.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"v_Error_Screenshot_Path"}},{"uid":"6be7e1bc-5599-4c3c-8e79-426332026773","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$v_Error_Screenshot_Path$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]},{"uid":"f4fc4751-0920-423a-add7-db01503fb8c5","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"email from -> $v_Email-From$\nEND user email to -> $v_End-User-Email-To$\nSUPPORT  -> $v_Support-Email-To$\nAUDIT LOG -> $v_Audit-Log-Path$\nERROR LOG -> $v_Error-Log-Path$\nError Ss path -> $v_Error_Screenshot_Path$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]}],"variables":[{"name":"v_Error-Log-Path","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"v_Audit-Log-Path","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"v_End-User-Email-To","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"v_Support-Email-To","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"v_Email-From","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"my-list-variable","description":"","type":"LIST","subtype":"STRING","input":true,"output":true,"defaultValue":{"type":"LIST","list":[{"type":"STRING","string":"my-value-1"},{"type":"STRING","string":"my-value-2"},{"type":"STRING","string":"my-value-3"},{"type":"STRING","string":"my-value-4"},{"type":"STRING","string":"my-value-5"}]}},{"name":"Prompt-Assignment","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"Test-Value"}},{"name":"v_Error_Screenshot_Path","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"Loop-Filedata-Column","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Filedata-Column-1","description":"","type":"RECORD","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Counter","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Loop-Counter-1","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"CSV-TXT-S1-DATA","description":"","type":"TABLE","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-string-1","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false}],"breakpoints":[],"packages":[{"name":"Comment","version":"2.6.0-20210504-152804"},{"name":"If","version":"3.0.0-20210504-152844"},{"name":"System","version":"3.3.0-20210419-071503"},{"name":"File","version":"4.0.0-20210504-152837"},{"name":"CsvTxt","version":"2.4.0-20210504-152806"},{"name":"DataTable","version":"2.8.0-20210504-153459"},{"name":"String","version":"4.1.0-20210427-194725"},{"name":"Loop","version":"3.0.0-20210504-152940"},{"name":"LegacyAutomation","version":"4.0.0-20210512-093900"},{"name":"Number","version":"3.0.0-20210504-153002"},{"name":"MessageBox","version":"3.0.0-20210504-152941"},{"name":"TaskBot","version":"2.0.1-20210503-140009"},{"name":"Folder","version":"4.0.0-20210504-152839"},{"name":"Email","version":"3.6.0-20210504-084515"}],"properties":{"improvedNumberSupport":true,"automationPriority":"PRIORITY_MEDIUM"}}